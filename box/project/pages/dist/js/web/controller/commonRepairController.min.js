function commonRepairController(a,e,t,n,i,r){a.data={},a.searchObj={},a.controllerName="commonRepair",a.redirectUrl="viewMyRepair",a.columns=[{data:"id"},{data:"maintenanceNumber"},{data:"maintenanceRecord.maintenanceArea.campus.name"},{data:"maintenanceRecord.maintenanceArea.name"},{data:"maintenanceRecord.maintenanceCategory.maintenanceType.name"},{data:"maintenanceRecord.maintenanceCategory.name"},{data:"maintenanceItemName"},{data:"repairStaff.name"},{data:"addDateTime"},{data:"maintenanceRecord.maintenanceStatus.name"},{data:"maintenanceTime"}],a.orderableAry=[0,1,2,3,4,5,7,9,10],a.wrapShortAry=[2,3,4,5,7],a.wrapAry=[6],a.order=[[8,"desc"]],a.redirectionNewPage=[1],a.dateFormatMonthDay=[8];var c="getMaintenanceRecord";a.url=c,a.reloadUrl=c,a.repairMethod=0,a.initDataTablesName="commonRepairDataTable",dataTables.init(a,e,t,n,i),r.all([getMaintenanceStatusData(a,e,t,n,i)]).then(function(){a.getThisYearUseDateInfo(a),a.peeledOffMaintenanceStatus(a),a.initDateTimeRange(),a.getSearchData()}),a.peeledOffMaintenanceStatus=function(a){var e=angular.copy(a.maintenanceStatusData),n=[];a.maintenanceStatusIds=[0];var i='<input type="checkbox" data-labelauty="全部" ng-model="maintenanceStatus._0" ng-click="changeMaintenanceStatus(0)"/>\n',r=["全部","本年","本月","本周","昨天","今天"],c="";angular.forEach(e,function(e){var t='<input type="checkbox" data-labelauty="'+e.name+'" ng-model="maintenanceStatus._'+e.id+'" ng-click="changeMaintenanceStatus('+e.id+')"/>\n',r={id:e.id,name:e.name};n.push(r),i+=t,a.maintenanceStatusIds.push(e.id)}),r.forEach(function(a,e){c+='<input type="checkbox" data-labelauty="'+a+'" ng-model="maintenanceTime._'+e+'" ng-click="changeMaintenanceTime(\'_'+e+"')\"/>\n"}),a.maintenanceStatus=[],t($("#maintenanceStatus").html(i))(a),t($("#maintenanceTime").html(c))(a),$(":checkbox").labelauty({minimum_width:"65px"}),a.initStatus()},a.initStatus=function(){a.maintenanceTime=[],a.maintenanceStatus._0=!0,a.maintenanceTime._3=!0},a.changeMaintenanceTime=function(e){a.maintenanceTime=[],a.maintenanceTime[e]=!0,a.changeDateTimeWithBtnType(e),a.getSearchData()},a.changeDateTimeWithBtnType=function(e){var t,e=e.split("_")[1],n=a.thisYearUseDateInfo,i=["thisYear","thisMonth","thisWeek","yesterday","today"],r=$("#dateTimeRange").data("daterangepicker");if(0==e)return $("#dateTimeRange").val(""),void $("#dateTimeRange").parent().addClass("hide");$("#dateTimeRange").parent().removeClass("hide");var c=n[t=i[e-1]],m=c.start,s=c.end;r.setStartDate(m),r.setEndDate(s)},a.changeMaintenanceStatus=function(e){if("0"==e)a.maintenanceStatus=[],a.maintenanceStatus._0=!0;else{var t=[];for(var e in a.maintenanceStatus)t.push(e);for(var n=0,i=0;i<t.length;i++)0==a.maintenanceStatus[t[i]]&&n++;t.length==n?a.maintenanceStatus._0=!0:a.maintenanceStatus._0=!1}a.getSearchData()},a.getSearchData=function(e){if(!e){var t=[],n=[];a.maintenanceStatusIds.forEach(function(e){a.maintenanceStatus["_"+e]&&t.push(e)});for(var i=0;i<6;i++)if(a.maintenanceTime["_"+i]){n.push(i);break}a.searchObj.searchStatusId=t.toString();var c=n.toString();a.dealSearchTimeFromTimeId(c)}a.addLoading(),r.all([a.initPagination(a)]).then(function(){$("#"+a.initDataTablesName).DataTable().ajax.reload(function(){a.removeLoading()},!0)})},a.dealSearchTimeFromTimeId=function(e){if(0==e)return delete a.searchObj.addDateTimeStart,void delete a.searchObj.addDateTimeEnd;1==e?(a.searchObj.addDateTimeStart=a.thisYearUseDateInfo.thisYear.start,a.searchObj.addDateTimeEnd=a.thisYearUseDateInfo.thisYear.end):2==e?(a.searchObj.addDateTimeStart=a.thisYearUseDateInfo.thisMonth.start,a.searchObj.addDateTimeEnd=a.thisYearUseDateInfo.thisMonth.end):3==e?(a.searchObj.addDateTimeStart=a.thisYearUseDateInfo.thisWeek.start,a.searchObj.addDateTimeEnd=a.thisYearUseDateInfo.thisWeek.end):4==e?(a.searchObj.addDateTimeStart=a.thisYearUseDateInfo.yesterday.start,a.searchObj.addDateTimeEnd=a.thisYearUseDateInfo.yesterday.end):5==e&&(a.searchObj.addDateTimeStart=a.thisYearUseDateInfo.today.start,a.searchObj.addDateTimeEnd=a.thisYearUseDateInfo.today.end)},a.initDateTimeRange=function(){$("#dateTimeRange").daterangepicker({applyClass:"btn-sm btn-success",cancelClass:"btn-sm btn-default",locale:{applyLabel:"确认",cancelLabel:"取消",fromLabel:"起始时间",toLabel:"结束时间",customRangeLabel:"自定义",firstDay:1,format:"YYYY-MM-DD",separator:"   至   ",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},timePicker:!1,ranges:{"今日":[moment().startOf("day"),moment()],"昨日":[moment().subtract("days",1).startOf("day"),moment().subtract("days",1).endOf("day")],"最近7日":[moment().subtract("days",6),moment()],"最近30日":[moment().subtract("days",29),moment()],"本月":[moment().startOf("month"),moment().endOf("month")],"上个月":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},startDate:a.thisYearUseDateInfo.thisWeek.start,endDate:a.thisYearUseDateInfo.thisWeek.end,opens:"left"},function(e,t,n){var i=e.format("YYYY-MM-DD"),r=t.format("YYYY-MM-DD");a.searchObj.addDateTimeStart=i,a.searchObj.addDateTimeEnd=r,a.checkBtnFromDateRange(i,r),a.getSearchData(!0)})},$(".applyBtn.btn.btn-sm.btn-success").bind("click",function(){a.getSearchData(!0)}),a.checkBtnFromDateRange=function(e,t){for(i=0;i<6;i++)a.$apply(function(){a.maintenanceTime["_"+i]=!1});var n=a.thisYearUseDateInfo;for(var i in n){var r=n[i];if(r.start==e&&r.end==t){var c=r.type<<0;a.$apply(function(){a.maintenanceTime["_"+c]=!0})}}}}angular.module("MetronicApp").controller("commonRepairController",["$scope","$http","$compile","$location","$filter","$q",commonRepairController]);