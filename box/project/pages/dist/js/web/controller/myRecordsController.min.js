function myRecordsController(a,e,t,n,r,i){a.data={},a.searchObj={},a.controllerName="myRecords",a.searchInit=!0,a.columns=[{data:"id"},{data:"maintenanceNumber"},{data:"maintenanceItemName"},{data:"maintenanceRecord.maintenanceCategory.maintenanceType.name"},{data:"maintenanceRecord.maintenanceCategory.name"},{data:"addDateTime"},{data:"maintenanceStaff.name"},{data:"maintenanceRecord.maintenanceStatus.name"},{data:"maintenanceTime"}],a.orderableAry=[0,1,2,3,4,6,7,8],a.order=[[5,"desc"]],a.wrapAry=[2,3,4],a.nullStr=[6],a.dateFormatMonthDay=[5],a.viewCommonRepairAry=[1],a.url="getMaintenanceRecord",a.searchObj={},a.searchObj.repairStaff={id:a.loginUser.id},a.initDataTablesName="myRecordsDataTable",dataTables.init(a,e,t,n,r),a.searchInit=!0,a.datetimepickerId=["addDateTime"],datePickers.init(a,e,t,n,r),a.search=function(){a.searchObj.repairStaff={id:a.loginUser.id},a.searchInfo(a)},a.reset=function(){a.resetSearch(a,e,t,n,r),a.resetDateTimePicker("addDateTimeEnd","addDateTimeStart")},a.commentModal=function(e){a.data.id=e,a.modalTitle="维修服务评价",$("#commentModal").modal()}}function myRecordsAddController(a,e,t,n,r,i,o,c){ComponentsBootstrapMaxlength.init(["maxlength_textarea2","maxlength_textarea1"]),a.uploadSuccessImgUrl=[],a.thisPageAddImgCount=0,a.uploadTypeOnlyImg=!0,a.maxImg=uploadImgMaxCount,Upload.init(a,c),getStatusUseTypeData(a,e,t,n,r),a.selectIdList=["select","select2","select3","select4"],i.all([getCampusSelectData(a,e,t,n,r)]).then(function(){return getMaintenanceAreaData(a,e,t,n,r)}).then(function(){return getMaintenanceTypeSelectData(a,e,t,n,r)}).then(function(){return getMaintenanceCategorySelectData(a,e,t,n,r)}),a.searchInit=!0,datePickers.init(a,e,t,n,r),a.$watch("data.maintenanceRecord.maintenanceArea.campus.id",function(e){var t=e,n=angular.copy(a.maintenanceAreaData),r=[];null!=t&&angular.forEach(n,function(a){a.campus.id==t&&r.push(a)}),a.maintenanceAreaDataFromCampus=r},!0),a.$watch("data.maintenanceRecord.maintenanceCategory.maintenanceType.id",function(e){var t=e,n=angular.copy(a.maintenanceCategorySelectData),r=[];null!=t&&angular.forEach(n,function(a){a.maintenanceType.id==t&&r.push(a)}),a.maintenanceCategoryDataFromType=r},!0),a.save=function(){a.addLoading(),a.url="saveMaintenanceRecord",a.data.repairStaff={id:a.loginUser.id},a.optName="添加";var e=a.unEmptyList(a.uploadSuccessImgUrl);a.data.fileUrls=e.join(","),a.params={data:JSON.stringify(a.data)},a.stateNewPage=!1,a.initDataTablesName="myRecordsDataTable",i.all([a.postApi(a)]).then(function(){a.reloadMyRecordAndRepairState(),o.go("myRecordsList")})}}function myRecordsViewController(a,e,t,n,r,i,o,c,d,l){var m;o.id&&(m=o.id),e({url:a.httpDomain+"getMaintenanceRecordById",method:"POST",data:{id:m},headers:{"logistics-session-token":a.getToken()}}).success(function(t){a.data=t.data;var n=t.data.repairMethod;a.data.repairMethod=1==n?"微信报修":"网页报修",a.url="getStockRemovalListByWarrantyNumber",a.params={id:m},e({url:a.httpDomain+a.url,method:"POST",data:a.params}).success(function(e){a.materialList=e.data})}),a.pageDate=(new Date).Format("yyyy 年 MM 月 dd 日"),a.openPrint=function(){a.modalTitle="维修表预览及打印",8==a.data.maintenanceRecord.maintenanceStatus.weight&&(a.data.maintenanceRecord.unableRepairReason="原因说明 : [ "+a.data.maintenanceRecord.unableRepairReason+" ]"),a.selectUrl="getStockRemovalMaterialNameFromWarrantyNumberId",a.selectParams={id:a.data.id},a.selectPara="materialListStr",a.selectOptName="获取用料信息",c.all([a.getSelectInfoApi(a)]).then(function(){"noData"===a.materialListStr&&(a.materialListStr="无领用记录"),$("#printingModal").modal()})},a.printThisPage=function(){$("#printPage").print()}}angular.module("MetronicApp").controller("myRecordsController",["$scope","$http","$compile","$location","$filter","$state",myRecordsController]),angular.module("MetronicApp").controller("myRecordsAddController",["$scope","$http","$compile","$location","$filter","$q","$state","$timeout",myRecordsAddController]),angular.module("MetronicApp").controller("myRecordsViewController",["$scope","$http","$compile","$location","$filter","$timeout","$stateParams","$q","$sce","$state",myRecordsViewController]);