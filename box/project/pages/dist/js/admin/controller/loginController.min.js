function loginController(e,t){$.backstretch(["../assets/pages/media/bg/1.jpg","../assets/pages/media/bg/2.jpg","../assets/pages/media/bg/3.jpg","../assets/pages/media/bg/4.jpg"],{fade:1e3,duration:8e3}),e.loadingConfig={loadingWidth:120,title:"正在登录...",name:"test",discription:"",direction:"column",type:"pic",imgSrc:"./../assets/global/img/loading.gif",originDivWidth:40,originDivHeight:40,originWidth:6,originHeight:6,smallLoading:!1,loadingMaskBg:"rgba(0,0,0,0.2)"},e.addLoading=function(){$("body").loading(e.loadingConfig)},e.removeLoading=function(){removeLoading("test")},e.getToken=function(){return localStorage.getItem("com.logistics.user.token")};var o=localStorage.getItem("com.logistics.user.rememberme"),r=localStorage.getItem("com.logistics.user.username"),a=localStorage.getItem("com.logistics.user.expired");"true"===a?(sweetAlert({title:"登录信息已过期！",text:"请重新登录",type:"warning",timer:2e3,showConfirmButton:!1}),localStorage.setItem("com.logistics.user.expired","false")):"NOADMINISTRATOR"===a&&(sweetAlert({title:"您没有权限访问！",text:"请使用管理员账号登录",type:"error",timer:2e3,showConfirmButton:!1}),localStorage.setItem("com.logistics.user.expired","false")),e.data={},null==o?localStorage.setItem("com.logistics.user.rememberme",!1):e.data.rememberme="true"==o,e.data.rememberme&&null!=r&&"undefined"!=r&&(e.data.username=r),e.login=function(){e.addLoading(),e.data.rememberme&&localStorage.setItem("com.logistics.user.username",e.data.username),e.url="login",e.params={rememberme:e.data.rememberme,account:e.data.username,password:e.data.password,administrator:!0},t({url:httpDomain+e.url,method:"POST",data:e.params,headers:{"logistics-session-token":e.getToken()}}).success(function(t,o,r,a){var s=function(){delete e.data.password,localStorage.setItem("com.logistics.user.token",null),localStorage.setItem("com.logistics.user.login",!1)};"NOADMINISTRATOR"===t.status&&(sweetAlert("警告","请使用管理员账号登录","warning"),s()),null!=t&&"NOTLOGIN"!==t.status||(sweetAlert("警告","密码已过期,请重新输入","warning"),s()),"SUCCESS"===t.status?(localStorage.setItem("com.logistics.user.login",!0),localStorage.setItem("com.logistics.user.token",t.token),localStorage.setItem("com.logistics.user.info",JSON.stringify(t.user)),e.loginCallback()):"ERROR"===t.status&&(sweetAlert("警告","用户名、密码错误！","error"),localStorage.setItem("com.logistics.user.login",!1)),e.removeLoading()}).error(function(t,o,r,a){localStorage.setItem("com.logistics.user.login",!1),sweetAlert("警告","登录异常,请重试!","error"),e.removeLoading()})},e.loginCallback=function(e){var t=portType+"://"+window.location.host+webLocationSuffix;window.location=t},e.changeRemember=function(){localStorage.setItem("com.logistics.user.rememberme",e.data.rememberme)}}var app=angular.module("LoginApp",[]);app.controller("loginController",["$scope","$http",loginController]),app.factory("sessionInjector",["$rootScope",function(e){var t=localStorage.getItem("com.logistics.user.token");return{request:function(e){return e.headers["logistics-session-token"]=t,e}}}]),app.config(["$httpProvider",function(e){e.defaults.transformRequest=function(e){return void 0===e?e:$.param(e)},e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"}]);